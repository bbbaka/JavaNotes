# HTTP      
定义了客户端和服务端通讯的数据格式          

- DNS : 负责解析域名，将域名和IP地址相互映射为一个分布式数据库，查询数据库将域名解析为主机的IP地址      
- HTTP ： 产生请求报文数据      
- TCP协议 : 分割 HTTP 数据，保证数据的准确运输
- IP协议 ： 传输数据包，找到通信的目的地址。IP地址可能会变换，可以使用ARP协议将IP地址反映射为MAC地址

## 1. HTTP 简介
### 1.1 告知服务器请求的意图
POST、GET、Input、Delete、OPTIONS等方法，告知服务器该客户端想进行的操作

### 1.2 无状态协议
HTTP协议不会对通信状态进行保存，不知道之前通信的双方是谁。      
服务器想知道访问的客户端是哪一个，就给客户端一个Cookie保存到硬盘，下次访问服务器的时候，浏览器自动把客户端的Cookie传过去        

### 1.3 持久连接        
HTTP1.0 时每一次进行HTTP通信就会断开一次连接，一个网页往往有多个HTTP请求，需要多次TCP连接，浪费资源          
HTTP1.1开始是持久连接，一次HTTP连接能够处理多个请求



## 2. HTTP报文
### 2.1 Request 请求报文
在请求中，HTTP报文由方法、URL、HTTP版本、HTTP首部字段等组成         
<center>

![请求报文2.png](https://s1.ax1x.com/2020/08/15/dkIcKs.png)
</center>

- **请求行：** 描述客户端的**请求方式、请求的资源名称**，以及使用的**HTTP协议版本号**
- **首部字段：** 描述客户端请求**哪台主机**，以及客户端的一些环境信息等     
- **空行：** 最后一个请求头之后是一个空行，发送回车符和换行符，通知服务器以下不再有请求头    
- **请求数据：** 请求数据不在GET方法中使用，而是在POST方法中使用。POST方法适用于需要客户填写表单的场合。与请求数据相关的最常使用的请求头是Content-Type和Content-Length

**请求方式**
- **GET：** 最常见，当客户端要从服务器中读取文档时，当点击网页上的链接或者通过在浏览器的地址栏输入网址来浏览网页的，使用的都是GET方式，使用GET方法时，**请求参数和对应的值附加在URL后面(在请求行中)**，利用一个问号（"?"）代表URL的结尾与请求参数的开始，传递参数长度受限制，一般不超过1024个字符，**不适合传输隐私数据或者数据量比较大的数据**      
- **POST：** 对于GET不适合的情况，可以使用POST方式，**POST方法将请求参数封装在HTTP请求体中，以名称/值的形式出现**，可以传输大量数据，这样POST方式对传送的数据大小没有限制，而且也不会显示在URL中，POST方式大多用于页面表单中   
- **HEAD：** HEAD就像GET，只不过服务端接受到HEAD请求后只返回响应头，而不会发送响应内容。当我们只需要查看某个页面的状态的时候，使用HEAD是非常高效的，因为在传输的过程中省去了页面内容     

**头部**            
请求头部由字段/值对组成，每行一对，关键字和值用英文冒号“:”分隔。请求头部通知服务器有关于客户端请求的信息        
- **User-Agent：** 产生请求的浏览器类型           
- **Accept：** 客户端可识别的内容类型列表（如：Accept: text/html,image/*    【浏览器告诉服务器，它支持的数据类型】）     
- **Host：** 请求的主机名，允许多个域名同处一个IP地址，即虚拟主机     
- **Cookie：** 浏览器告诉服务器，带来的Cookie


### 2.2 Response 响应报文

![响应报文.png](https://s1.ax1x.com/2020/08/15/dk5llj.png)

- HTTP响应也由三个部分组成，分别是：状态行、消息报头、响应正文  
- 在响应中唯一真正的区别在于第一行中用**状态信息**代替了请求信息。状态行（status line）通过提供一个状态码来说明所请求的资源情况 

#### 2.2.1 状态行            
状态行格式：HTTP-Version Status-Code Reason-Phrase CRLF             
HTTP-Version表示服务器HTTP协议的版本；Status-Code表示服务器发回的响应状态代码；Reason-Phrase表示状态代码的文本描述。状态代码由三位数字组成，第一个数字定义了响应的类别，且有五种可能取值。

**响应状态码**    
- 1xx：**指示信息**--表示请求已接收客户端消息，但没有接收完成，需要继续处理(客户端继续发送等)

- 2xx：**成功**--表示请求已被成功接收、理解、接受
  - **200 OK 正常处理**        
  - 204 成功处理，但服务器没有新数据返回，显示页面不更新        
  - 206 对服务器进行范围请求，只返回一部分数据
 
- 3xx：**重定向**--要完成请求必须进行更进一步的操作
  - 301 **永久重定向**，请求的资源已分配了新的URI，原URL地址改变了，以后应使用新的URL访问，常用作域名跳转              
  - 302 **临时重定向**，请求的资源临时分配了新的URI中，原URL地址没变，常用作临时跳转如未登录访问用户中心跳转登录页           
  - 303 请求资源路径发生改变，与302功能一样，但明确指出客户端应该采用GET方式来请求新URL          
  - 304 访问的是未更改(未过期)的本地缓存资源        
  - 307 与302相同，但不会把POST请求变成GET      
  - 301与302：用户都可以看到url替换为了一个新的，都根据服务器返回的location进行二次请求，但是301是可以缓存的，在抓取新的内容的同时也将旧的网址替换为了重定向之后的网址，但是302是暂时的，抓取新内容也保留旧的地址

- 4xx：**客户端错误**--请求有语法错误或请求无法实现
  - **400 Bad Request 请求报文语法错误了**      
  - **401 Unauthorized 请求未经授权，需要认证身份**        
  - **403 Forbidden 服务器收到，但是拒绝提供服务**           
  - **404 Not Found 请求的资源不存在**    
  - **405 Method not allowed 请求方式没有对应的doxxx方法**  

- 5xx：**服务器端错误**--服务器未能实现合法的请求        
  - **500 Internal Server Error 服务器内部资源出错了**      
  - **503 服务器正忙，不能处理客户请求，一段时间后恢复服务**  

~~~http
HTTP/1.1 200 OK
Date: Sat, 31 Dec 2005 23:59:59 GMT
Content-Type: text/html;charset=ISO-8859-1
Content-Length: 122

<html>
<head>
<title>Wrox Homepage</title>
</head>
<body>
<!-- body goes here -->
</body>
</html>
~~~

#### 2.2.2 响应头   
- 请求头格式：`头部字段：值`  
- **Content-Type**: text/html;charset=utf-8 ： content-type 服务器告诉客户端本次响应体数据格式以及编码格式
- **Content-disposition**: in-line ： 服务器告诉客户端以什么格式打开响应体数据(in-line默认值表示在当前页面打开，**attachment表示以附件形式打开响应体如文件下载**时)         
- **location**： 重定向时，指明重定向的资源路径     

#### 2.2.3 响应空行   

#### 2.2.4 响应体      
- 传输的数据   
